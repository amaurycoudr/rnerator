import { Extension } from '../type/type';
import { getNoTextIfJs } from '../utils/string';
import SandboxFile from './SandboxFile';

class SandboxFilesContent {
  private sandboxString: SandboxFile[];

  private extension: Extension = 'ts';

  private getFileStart = () =>
    `// THIS IS AN AUTOGENERATED FILE. DO NOT EDIT THIS FILE DIRECTLY.` +
    `\n` +
    `/* eslint global-require: off */` +
    `${getNoTextIfJs(this.extension)(
      "\nimport { FC } from 'react'\ntype SandBoxInfo = { name: string; location: string; component: FC };"
    )}`;

  private fileEnd = '\nexport default data;';

  constructor(paths: string[], extension: Extension) {
    this.sandboxString = paths.map(SandboxFile.new);
    this.extension = extension;
  }

  get content() {
    return this.getFileStart() + this.getData() + this.fileEnd;
  }

  private getData = () =>
    `\nconst data${getNoTextIfJs(this.extension)(
      ': SandBoxInfo[]'
    )} = [${this.getSandboxDataList()}];`;

  private getSandboxDataList = () =>
    this.sandboxString.map((path) => path.string);
}

export default SandboxFilesContent;
